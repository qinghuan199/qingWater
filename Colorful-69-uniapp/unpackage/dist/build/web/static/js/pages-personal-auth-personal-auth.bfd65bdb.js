(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-personal-auth-personal-auth"],{"04ae":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"personal-auth-page"},[a("v-uni-view",{staticClass:"header"},[a("v-uni-view",{staticClass:"back-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goBack.apply(void 0,arguments)}}},[a("v-uni-image",{staticClass:"back-icon",attrs:{src:"/static/icon/back.png"}})],1),a("v-uni-view",{staticClass:"title"},[t._v("个人认证")])],1),a("v-uni-view",{staticClass:"form-container"},[a("v-uni-view",{staticClass:"form-item"},[a("v-uni-view",{staticClass:"label"},[t._v("联系电话")]),a("v-uni-input",{staticClass:"input",attrs:{placeholder:"请输入联系电话"},model:{value:t.formData.mobile,callback:function(e){t.$set(t.formData,"mobile",e)},expression:"formData.mobile"}})],1),a("v-uni-view",{staticClass:"form-item"},[a("v-uni-view",{staticClass:"label"},[t._v("年龄")]),a("v-uni-input",{staticClass:"input",attrs:{placeholder:"请输入年龄",type:"number"},model:{value:t.formData.age,callback:function(e){t.$set(t.formData,"age",e)},expression:"formData.age"}})],1),a("v-uni-view",{staticClass:"form-item"},[a("v-uni-view",{staticClass:"label"},[t._v("最低价格")]),a("v-uni-input",{staticClass:"input",attrs:{placeholder:"请输入最低价格",type:"number"},model:{value:t.formData.min_price,callback:function(e){t.$set(t.formData,"min_price",e)},expression:"formData.min_price"}})],1),a("v-uni-view",{staticClass:"form-item"},[a("v-uni-view",{staticClass:"label"},[t._v("消费情况")]),a("v-uni-input",{staticClass:"input",attrs:{placeholder:"请输入消费情况"},model:{value:t.formData.consumption_situation,callback:function(e){t.$set(t.formData,"consumption_situation",e)},expression:"formData.consumption_situation"}})],1),a("v-uni-view",{staticClass:"form-item"},[a("v-uni-view",{staticClass:"label"},[t._v("服务项目")]),a("v-uni-input",{staticClass:"input",attrs:{placeholder:"请输入服务项目"},model:{value:t.formData.service_project,callback:function(e){t.$set(t.formData,"service_project",e)},expression:"formData.service_project"}})],1),a("v-uni-view",{staticClass:"form-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showResourceTypeModal.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"label"},[t._v("资源类型")]),a("v-uni-view",{staticClass:"input-like",class:{placeholder:!t.selectedResourceType}},[t._v(t._s(t.selectedResourceType||"请选择资源类型"))]),a("v-uni-image",{staticClass:"arrow-icon",attrs:{src:"/static/icon/arrow-right.png"}})],1),a("v-uni-view",{staticClass:"form-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goToAddress.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"label"},[t._v("服务地区")]),a("v-uni-view",{staticClass:"input-like",class:{placeholder:!t.selectedAddress}},[t._v(t._s(t.selectedAddress||"请选择服务地区"))]),a("v-uni-image",{staticClass:"arrow-icon",attrs:{src:"/static/icon/arrow-right.png"}})],1),a("v-uni-view",{staticClass:"form-items"},[a("v-uni-view",{staticClass:"label"},[t._v("个人照片")]),a("v-uni-view",{staticClass:"image-tip m-b-20"},[t._v("(温馨提示：请上传本人的真实照片)")]),a("v-uni-view",{staticClass:"image-upload"},[a("v-uni-view",{staticClass:"image-list"},[t._l(t.formData.image,(function(e,i){return a("v-uni-view",{key:i,staticClass:"image-item"},[a("v-uni-image",{staticClass:"uploaded-image",attrs:{src:t.getImageUrl(e),mode:"aspectFill"}}),a("v-uni-view",{staticClass:"delete-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.deleteImage(i)}}},[t._v("×")])],1)})),t.formData.image.length<9?a("v-uni-view",{staticClass:"add-image-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseImage.apply(void 0,arguments)}}},[a("v-uni-image",{staticClass:"add-icon",attrs:{src:"/static/home/ic_photo_add.png"}})],1):t._e()],2)],1)],1),a("v-uni-view",{staticClass:"form-items"},[a("v-uni-view",{staticClass:"label"},[t._v("本人健康证明")]),a("v-uni-view",{staticClass:"image-tip m-b-20"},[t._v("(温馨提示：请上传一年内的健康证明)")]),a("v-uni-view",{staticClass:"image-upload"},[a("v-uni-view",{staticClass:"image-list"},[t.formData.health_certificate?a("v-uni-view",{staticClass:"image-item"},[a("v-uni-image",{staticClass:"uploaded-image",attrs:{src:t.getImageUrl(t.formData.health_certificate),mode:"aspectFill"}}),a("v-uni-view",{staticClass:"delete-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.deleteHealthCertificate.apply(void 0,arguments)}}},[t._v("×")])],1):t._e(),t.formData.health_certificate?t._e():a("v-uni-view",{staticClass:"add-image-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseHealthCertificate.apply(void 0,arguments)}}},[a("v-uni-image",{staticClass:"add-icon",attrs:{src:"/static/home/ic_photo_add.png"}})],1)],1)],1)],1)],1),a("v-uni-view",{staticClass:"bottom-actions"},[a("v-uni-button",{staticClass:"submit-btn",attrs:{disabled:t.submitting},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submitAuth.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"btn-text"},[t._v(t._s(t.submitting?"提交中...":"提交认证"))])],1)],1),t.showResourceModal?a("v-uni-view",{staticClass:"modal-overlay",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideResourceTypeModal.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"modal-content",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)}}},[a("v-uni-view",{staticClass:"modal-header"},[a("v-uni-text",{staticClass:"modal-title"},[t._v("选择资源类型")]),a("v-uni-text",{staticClass:"modal-close",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideResourceTypeModal.apply(void 0,arguments)}}},[t._v("×")])],1),a("v-uni-view",{staticClass:"modal-body"},t._l(t.resourceTypeList,(function(e){return a("v-uni-view",{key:e.id,staticClass:"resource-item",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.selectResourceType(e)}}},[a("v-uni-text",{staticClass:"resource-name"},[t._v(t._s(e.name))])],1)})),1)],1)],1):t._e()],1)},o=[]},"2b6f":function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".personal-auth-page[data-v-818a565a]{min-height:100vh;background-color:#f5f5f5;padding-bottom:%?120?%}\n\n/* 头部样式 */.header[data-v-818a565a]{position:fixed;top:0;left:0;right:0;height:%?88?%;background-color:#fff;display:flex;align-items:center;justify-content:center;z-index:999;border-bottom:%?1?% solid #eee}.back-btn[data-v-818a565a]{position:absolute;left:%?30?%;width:%?60?%;height:%?60?%;display:flex;align-items:center;justify-content:center}.back-icon[data-v-818a565a]{width:%?40?%;height:%?40?%}.title[data-v-818a565a]{font-size:%?36?%;color:#333}\n\n/* 表单样式 */.form-container[data-v-818a565a]{padding:%?120?% %?0?% %?30?%;background-color:#fff;min-height:100vh}.form-item[data-v-818a565a]{display:flex;align-items:center;background-color:#fff;padding:%?30?% %?40?%;margin-bottom:%?20?%;border-radius:%?16?%;position:relative}.label[data-v-818a565a]{width:%?200?%;font-size:%?32?%;color:#333;font-weight:500;flex-shrink:0}.form-items[data-v-818a565a]{display:flex;flex-direction:column;background-color:#fff;padding:%?30?% %?40?%;margin-bottom:%?20?%;border-radius:%?16?%;position:relative}.labels[data-v-818a565a]{width:%?200?%;font-size:%?32?%;color:#333;font-weight:500;flex-shrink:0}.required[data-v-818a565a]{color:#fff}.input[data-v-818a565a]{flex:1;font-size:%?32?%;color:#333;padding-left:%?20?%;text-align:right;border:none;background:transparent}.input-like[data-v-818a565a]{flex:1;font-size:%?32?%;color:#333;padding:%?20?% 0 %?20?% %?20?%;text-align:right}.input-like.placeholder[data-v-818a565a]{color:#999}.arrow-icon[data-v-818a565a]{width:%?30?%;height:%?30?%;margin-left:%?20?%}.textarea[data-v-818a565a]{flex:1;font-size:%?30?%;color:#999;margin-top:%?10?%;padding:%?15?%;min-height:%?200?%;background-color:#eee;border:none;border-radius:%?8?%}\n\n/* 图片上传样式 */.image-upload[data-v-818a565a]{flex:1;padding-left:%?20?%}.image-list[data-v-818a565a]{display:flex;flex-wrap:wrap;gap:%?20?%}.image-item[data-v-818a565a]{position:relative;width:%?150?%;height:%?150?%}.uploaded-image[data-v-818a565a]{width:100%;height:100%;border-radius:%?12?%}.delete-btn[data-v-818a565a]{position:absolute;top:%?-10?%;right:%?-10?%;width:%?40?%;height:%?40?%;background-color:#ff4757;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:%?24?%}.add-image-btn[data-v-818a565a]{width:%?150?%;height:%?150?%;border-radius:%?12?%;display:flex;flex-direction:column;align-items:center;justify-content:center}.add-icon[data-v-818a565a]{width:100%;height:100%;margin-bottom:%?10?%}.add-text[data-v-818a565a]{font-size:%?24?%;color:#999}.image-tip[data-v-818a565a]{font-size:%?24?%;color:#fd264c;margin-top:%?10?%}\n\n/* 底部按钮 */.bottom-actions[data-v-818a565a]{position:fixed;bottom:0;left:0;right:0;background-color:#fff;padding:%?30?% %?40?%;border-top:%?1?% solid #eee}.submit-btn[data-v-818a565a]{width:100%;height:%?88?%;background:#fd264c;border-radius:%?20?%;display:flex;align-items:center;justify-content:center;border:none}.submit-btn[data-v-818a565a]:disabled{background-color:#ccc}.btn-text[data-v-818a565a]{font-size:%?32?%;color:#fff;font-weight:700}\n\n/* 弹窗样式 */.modal-overlay[data-v-818a565a]{position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.5);z-index:1000;display:flex;align-items:center;justify-content:center}.modal-content[data-v-818a565a]{width:%?600?%;max-height:80vh;background-color:#fff;border-radius:%?20?%;overflow:hidden}.modal-header[data-v-818a565a]{display:flex;align-items:center;justify-content:space-between;padding:%?30?%;border-bottom:%?1?% solid #eee}.modal-title[data-v-818a565a]{font-size:%?36?%;color:#333;font-weight:500}.modal-close[data-v-818a565a]{font-size:%?40?%;color:#999}.modal-body[data-v-818a565a]{max-height:60vh;overflow-y:auto}.resource-item[data-v-818a565a]{padding:%?30?%;border-bottom:%?1?% solid #f5f5f5}.resource-item[data-v-818a565a]:last-child{border-bottom:none}.resource-name[data-v-818a565a]{font-size:%?32?%;color:#333}",""]),t.exports=e},"3de7d":function(t,e,a){var i=a("2b6f");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var o=a("967d").default;o("53ab0aff",i,!0,{sourceMap:!1,shadowMode:!1})},"4c0a":function(t,e,a){"use strict";a.r(e);var i=a("931f"),o=a.n(i);for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=o.a},"931f":function(t,e,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i(a("2634")),n=i(a("2fdc"));a("e966"),a("aa9c"),a("bf0f"),a("4626"),a("5ac7"),a("dd2b");var s={data:function(){return{formData:{mobile:"",age:"",min_price:"",consumption_situation:"",service_project:"",resource_type:0,province_id:"",city_id:"",area_id:"",image:[],health_certificate:"",loufeng_type:1},resourceTypeList:[],showResourceModal:!1,selectedResourceType:"",selectedAddress:"",submitting:!1,authInfo:{one:200,more:1e3}}},onLoad:function(){this.getResourceTypeList(),this.getAuthInfo()},onShow:function(){var t=uni.getStorageSync("personalAuthSelectedAddress");t&&(this.selectedAddress=t.fullAddress,this.formData.province_id=t.province_id,this.formData.city_id=t.city_id,this.formData.area_id=t.area_id,uni.removeStorageSync("personalAuthSelectedAddress"))},methods:{goBack:function(){uni.navigateBack()},getResourceTypeList:function(){var t=this,e=getApp().getCache("userInfo");if(e&&e.token){var a={token:e.token};getApp().getData("api/loufeng/type",a,(function(e){200==e.code&&e.data&&(t.resourceTypeList=e.data)}))}},getAuthInfo:function(){var t=this,e=getApp().getCache("userInfo");if(e&&e.token){var a={token:e.token};getApp().getData("api/loufeng/info",a,(function(e){200==e.code&&e.data&&(t.authInfo=e.data)}))}},showResourceTypeModal:function(){this.showResourceModal=!0},hideResourceTypeModal:function(){this.showResourceModal=!1},selectResourceType:function(t){this.formData.resource_type=parseInt(t.id),this.selectedResourceType=t.name,this.hideResourceTypeModal()},goToAddress:function(){uni.navigateTo({url:"/pages/auth-address/auth-address?from=personalAuth&level=0"})},chooseImage:function(){var t=this;uni.chooseImage({count:9-this.formData.image.length,sizeType:["compressed"],sourceType:["album","camera"],success:function(){var e=(0,n.default)((0,o.default)().mark((function e(a){var i,n,s;return(0,o.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=0;case 1:if(!(i<a.tempFilePaths.length)){e.next=20;break}return e.prev=2,uni.showLoading({title:"上传图片中..."}),e.next=6,t.uploadImage(a.tempFilePaths[i]);case 6:n=e.sent,s=n.personal_photo||n.url||n,t.formData.image.push(s),uni.hideLoading(),e.next=17;break;case 12:return e.prev=12,e.t0=e["catch"](2),uni.hideLoading(),uni.showToast({title:e.t0||"图片上传失败",icon:"none"}),e.abrupt("break",20);case 17:i++,e.next=1;break;case 20:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t){return e.apply(this,arguments)}}()})},chooseHealthCertificate:function(){var t=this;uni.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(){var e=(0,n.default)((0,o.default)().mark((function e(a){var i,n;return(0,o.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,uni.showLoading({title:"上传图片中..."}),e.next=4,t.uploadImage(a.tempFilePaths[0]);case 4:i=e.sent,n=i.health_certificate||i.url||i,t.formData.health_certificate=n,uni.hideLoading(),e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](0),uni.hideLoading(),uni.showToast({title:e.t0||"图片上传失败",icon:"none"});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()})},uploadImage:function(t){return new Promise((function(e,a){var i=getApp().getCache("userInfo");uni.uploadFile({url:"http://103.43.71.158/api/upload/image",filePath:t,name:"image",header:{token:i.token},success:function(t){try{var i=JSON.parse(t.data);200===i.code?e(i.data):a(i.msg||"上传失败")}catch(o){a("上传失败")}},fail:function(t){a("上传失败")}})}))},getImageUrl:function(t){return t?t.includes("http")?t:"http://103.43.71.158"+t:""},deleteImage:function(t){this.formData.image.splice(t,1)},deleteHealthCertificate:function(){this.formData.health_certificate=""},submitAuth:function(){if(!this.submitting)if(this.formData.mobile)if(this.formData.age)if(this.formData.min_price)if(this.formData.consumption_situation)if(this.formData.service_project)if(!this.formData.resource_type||this.formData.resource_type<=0)uni.showToast({title:"请选择资源类型",icon:"none"});else if(this.formData.province_id&&this.formData.city_id)if(0!==this.formData.image.length)if(this.formData.health_certificate){this.submitting=!0;var t=this,e=getApp().getCache("userInfo"),a={token:e.token,age:parseInt(this.formData.age),service_project:this.formData.service_project,province_id:parseInt(this.formData.province_id),city_id:parseInt(this.formData.city_id),area_id:parseInt(this.formData.area_id||0),mobile:this.formData.mobile,min_price:this.formData.min_price,consumption_situation:this.formData.consumption_situation,image:this.formData.image,resource_type:parseInt(this.formData.resource_type),loufeng_type:1,health_certificate:this.formData.health_certificate};getApp().getData("api/loufeng/auth",a,(function(e){t.submitting=!1,403==e.code?(uni.showToast({title:e.msg,icon:"success"}),setTimeout((function(){uni.navigateTo({url:"/pages/order/order"})}),1e3)):uni.showToast({title:e.msg||"提交失败",icon:"none"})}))}else uni.showToast({title:"请上传健康证明",icon:"none"});else uni.showToast({title:"请上传个人照片",icon:"none"});else uni.showToast({title:"请选择服务地区",icon:"none"});else uni.showToast({title:"请输入服务项目",icon:"none"});else uni.showToast({title:"请输入消费情况",icon:"none"});else uni.showToast({title:"请输入最低价格",icon:"none"});else uni.showToast({title:"请输入年龄",icon:"none"});else uni.showToast({title:"请输入联系电话",icon:"none"})},createAuthOrder:function(){uni.showLoading({title:"创建订单中..."});var t={type:"normal",info_id:1,amount:this.authInfo.one},e=this;getApp().getData("/api/order/create",t,(function(t){if(uni.hideLoading(),200===t.code){var a=t.data;e.payAuthOrder(a)}else uni.showToast({title:t.msg||"创建订单失败",icon:"none"})}))},payAuthOrder:function(t){var e=this;uni.showActionSheet({itemList:["余额支付","微信支付","支付宝支付"],success:function(a){var i=[0,1,2][a.tapIndex];e.performAuthPayment(t,i)}})},performAuthPayment:function(t,e){uni.showLoading({title:"处理支付中..."});var a={id:t,paytype:0,type:"normal"},i=this;getApp().getData("/api/order/pay",a,(function(t){uni.hideLoading(),200===t.code?0===e?(uni.showToast({title:"支付成功",icon:"success",duration:1e3}),setTimeout((function(){uni.navigateBack()}),1e3)):i.handleAuthPaymentResult(t.data):uni.showToast({title:t.msg||"支付失败",icon:"none"})}))},handleAuthPaymentResult:function(t){t.payUrl&&uni.showModal({title:"支付提示",content:"请在新页面完成支付",showCancel:!1,confirmText:"确定",success:function(e){e.confirm&&window.open(t.payUrl,"_blank")}})}}};e.default=s},9641:function(t,e,a){"use strict";var i=a("3de7d"),o=a.n(i);o.a},e477:function(t,e,a){"use strict";a.r(e);var i=a("04ae"),o=a("4c0a");for(var n in o)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return o[t]}))}(n);a("9641");var s=a("828b"),r=Object(s["a"])(o["default"],i["b"],i["c"],!1,null,"818a565a",null,!1,i["a"],void 0);e["default"]=r.exports}}]);