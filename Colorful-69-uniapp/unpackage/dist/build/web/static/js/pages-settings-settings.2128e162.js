(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-settings-settings"],{"209b":function(t,e,a){"use strict";a.r(e);var n=a("436b"),i=a("9bfe");for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);a("5c44");var s=a("828b"),r=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"6c255df7",null,!1,n["a"],void 0);e["default"]=r.exports},"436b":function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return n}));var n={uPicker:a("377e").default},i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"settings-page"},[a("v-uni-view",{staticClass:"header"},[a("v-uni-view",{staticClass:"back-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goBack.apply(void 0,arguments)}}},[a("v-uni-image",{staticClass:"back-icon",attrs:{src:"/static/home/ic_common_back.png",mode:"aspectFit"}})],1),a("v-uni-text",{staticClass:"header-title"},[t._v("设置")]),a("v-uni-view",{staticClass:"placeholder"})],1),a("v-uni-view",{staticClass:"settings-container"},[a("v-uni-view",{staticClass:"setting-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changeAvatar.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"setting-label"},[t._v("头像")]),a("v-uni-view",{staticClass:"setting-value"},[a("v-uni-image",{staticClass:"avatar-preview",attrs:{src:t.userInfo.header_img||"/static/icon/default-avatar.png",mode:"aspectFill"}}),a("v-uni-image",{staticClass:"arrow-icon",attrs:{src:"/static/home/ic_arrow_right.png",mode:"aspectFit"}})],1)],1)],1),a("v-uni-view",{staticClass:"settings-container"},[a("v-uni-view",{staticClass:"setting-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changeNickname.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"setting-label"},[t._v("昵称")]),a("v-uni-view",{staticClass:"setting-value"},[a("v-uni-text",{staticClass:"setting-text"},[t._v(t._s(t.userInfo.name||"未设置"))]),a("v-uni-image",{staticClass:"arrow-icon",attrs:{src:"/static/home/ic_arrow_right.png",mode:"aspectFit"}})],1)],1),a("v-uni-view",{staticClass:"setting-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.showGenderPicker=!0}}},[a("v-uni-text",{staticClass:"setting-label"},[t._v("性别")]),a("v-uni-view",{staticClass:"setting-value"},[a("v-uni-text",{staticClass:"setting-text"},[t._v(t._s(t.getGenderText()))]),a("v-uni-image",{staticClass:"arrow-icon",attrs:{src:"/static/home/ic_arrow_right.png",mode:"aspectFit"}})],1)],1),a("u-picker",{attrs:{show:t.showGenderPicker,columns:t.genderColumns,title:"性别"},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.onGenderConfirm.apply(void 0,arguments)},cancel:function(e){arguments[0]=e=t.$handleEvent(e),t.showGenderPicker=!1}}}),a("v-uni-view",{staticClass:"setting-item"},[a("v-uni-text",{staticClass:"setting-label"},[t._v("手机号")]),a("v-uni-view",{staticClass:"setting-value"},[a("v-uni-text",{staticClass:"setting-text"},[t._v(t._s(t.userInfo.phone||"未绑定"))])],1)],1),a("v-uni-view",{staticClass:"setting-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changeBrief.apply(void 0,arguments)}}},[a("v-uni-text",{staticClass:"setting-label"},[t._v("个人简介")]),a("v-uni-view",{staticClass:"setting-value"},[a("v-uni-image",{staticClass:"arrow-icon",attrs:{src:"/static/home/ic_arrow_right.png",mode:"aspectFit"}})],1)],1),a("v-uni-text",{staticClass:"setting-text brief-text"},[t._v(t._s(t.userInfo.brief_introduction||"未设置"))])],1),a("v-uni-view",{staticClass:"logout-container"},[a("v-uni-button",{staticClass:"logout-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.logout.apply(void 0,arguments)}}},[t._v("退出登录")])],1)],1)},o=[]},"5c44":function(t,e,a){"use strict";var n=a("a03b"),i=a.n(n);i.a},"8f6a":function(t,e,a){"use strict";a("6a54"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={data:function(){return{userInfo:getApp().getCache("userInfo"),showGenderPicker:!1,genderColumns:[["未知","男","女"]]}},onLoad:function(){this.getUserInfo()},onShow:function(){var t=getApp().getCache("isLogin");getApp().isEmpty(t)?uni.navigateTo({url:"/pages/login/login"}):this.getUserInfo()},methods:{getUserInfo:function(){var t=this,e=getApp().getCache("userInfo"),a=e?e.token:null;if(!a)return uni.showToast({title:"请先登录",icon:"none"}),void this.clearUserData();uni.request({url:getApp().globalData.baseUrl+"api/getuserinfo",method:"POST",header:{token:a},success:function(e){200===e.data.code?t.userInfo=e.data.data:uni.showToast({title:e.data.msg||"获取用户信息失败",icon:"none"})},fail:function(){uni.showToast({title:"网络错误",icon:"none"})}})},goBack:function(){uni.navigateBack()},getGenderText:function(){switch(this.userInfo.sex){case"0":case 0:return"未知";case"1":case 1:return"男";case"2":case 2:return"女";default:return"未知"}},changeAvatar:function(){var t=this;uni.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(e){var a=e.tempFilePaths[0];t.uploadAvatar(a)}})},uploadAvatar:function(t){var e=this,a=getApp().getCache("userInfo"),n=a?a.token:null;uni.showLoading({title:"上传中..."}),uni.uploadFile({url:getApp().globalData.baseUrl+"api/upload/image",filePath:t,name:"image",header:{token:n},success:function(t){uni.hideLoading();var a=JSON.parse(t.data);200===a.code?e.setAvatar(a.data):uni.showToast({title:a.msg||"上传失败",icon:"none"})},fail:function(){uni.hideLoading(),uni.showToast({title:"上传失败",icon:"none"})}})},setAvatar:function(t){var e=this,a=getApp().getCache("userInfo"),n=a?a.token:null;uni.request({url:getApp().globalData.baseUrl+"api/setheadimg",method:"POST",header:{token:n},data:{header_img:t},success:function(a){200===a.data.code?(uni.showToast({title:"头像更新成功",icon:"success"}),e.userInfo.header_img=t):uni.showToast({title:a.data.msg||"设置失败",icon:"none"})},fail:function(){uni.showToast({title:"网络错误",icon:"none"})}})},changeNickname:function(){uni.navigateTo({url:"/pages/nickname-edit/nickname-edit?nickname="+encodeURIComponent(this.userInfo.name||"")})},onGenderConfirm:function(t){var e=t.indexs[0],a=e;this.saveGender(a),this.showGenderPicker=!1},saveGender:function(t){var e=this,a=getApp().getCache("userInfo"),n=a?a.token:null;uni.request({url:getApp().globalData.baseUrl+"api/setsex",method:"POST",header:{token:n},data:{sex:t},success:function(a){200===a.data.code?(uni.showToast({title:"性别更新成功",icon:"success"}),e.userInfo.sex=t):uni.showToast({title:a.data.msg||"设置失败",icon:"none"})},fail:function(){uni.showToast({title:"网络错误",icon:"none"})}})},changeBrief:function(){uni.navigateTo({url:"/pages/brief-edit/brief-edit?brief="+encodeURIComponent(this.userInfo.brief_introduction||"")})},goToOriginalVideos:function(){uni.navigateTo({url:"/pages/original-videos/original-videos"})},saveBrief:function(t){var e=this,a=getApp().getCache("userInfo"),n=a?a.token:null;uni.request({url:getApp().globalData.baseUrl+"api/set/brief/introduction",method:"POST",header:{token:n},data:{content:t},success:function(a){200===a.data.code?(uni.showToast({title:"简介更新成功",icon:"success"}),e.userInfo.brief_introduction=t,getApp().setCache("userInfo",e.userInfo)):uni.showToast({title:a.data.msg||"设置失败",icon:"none"})},fail:function(){uni.showToast({title:"网络错误",icon:"none"})}})},logout:function(){var t=this;uni.showModal({title:"提示",content:"确定要退出登录吗？",success:function(e){e.confirm&&t.performLogout()}})},performLogout:function(){var t=this,e=getApp().getCache("userInfo"),a=e?e.token:null;a?uni.request({url:getApp().globalData.baseUrl+"api/logout",method:"POST",header:{token:a},success:function(e){200===e.data.code?uni.showToast({title:"退出成功",icon:"success"}):uni.showToast({title:e.data.msg||"退出失败",icon:"none"}),t.clearUserData()},fail:function(){uni.showToast({title:"网络错误",icon:"none"}),t.clearUserData()}}):this.clearUserData()},clearUserData:function(){uni.removeStorageSync("isLogin"),uni.removeStorageSync("userInfo"),uni.reLaunch({url:"/pages/index/index"})}}};e.default=n},"968a":function(t,e,a){var n=a("c86c");e=n(!1),e.push([t.i,'.settings-page[data-v-6c255df7]{background-color:#f5f5f5;min-height:100vh}[data-v-6c255df7] .u-toolbar__wrapper__confirm{color:#909193!important}[data-v-6c255df7] .u-toolbar{border-bottom:%?1?% solid #eee!important}\n\n/* 头部导航 */.header[data-v-6c255df7]{display:flex;align-items:center;justify-content:space-between;padding:%?20?% %?30?%;background-color:#fff;border-bottom:%?1?% solid #e0e0e0}.back-btn[data-v-6c255df7]{padding:%?10?%}.back-icon[data-v-6c255df7]{width:%?40?%;height:%?40?%}.header-title[data-v-6c255df7]{font-size:%?32?%;color:#333}.placeholder[data-v-6c255df7]{width:%?60?%}\n\n/* 设置项容器 */.settings-container[data-v-6c255df7]{background-color:#fff;padding:%?20?%;margin:%?20?% 0;box-shadow:0 %?4?% %?12?% rgba(0,0,0,.1)}.setting-item[data-v-6c255df7]{display:flex;align-items:center;justify-content:space-between;padding:%?30?% %?20?%;border-bottom:%?1?% solid #f0f0f0;transition:background-color .3s}.setting-item[data-v-6c255df7]:last-child{border-bottom:none}.setting-item[data-v-6c255df7]:active{background-color:#f8f8f8}.setting-label[data-v-6c255df7]{font-size:%?32?%;color:#333}.setting-value[data-v-6c255df7]{display:flex;align-items:center}.setting-text[data-v-6c255df7]{font-size:%?32?%;color:#b4b4b4;margin-right:%?20?%}.brief-text[data-v-6c255df7]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3;\n\t/* 限制显示2行 */overflow:hidden;text-overflow:ellipsis;font-size:%?28?%;color:#999;margin-top:%?10?%;line-height:1.4;word-break:break-all\n\t/* 允许单词内换行 */}.avatar-preview[data-v-6c255df7]{width:%?92?%;height:%?92?%;border-radius:%?46?%;margin-right:%?20?%;border:%?2?% solid #e0e0e0}.arrow-icon[data-v-6c255df7]{width:%?30?%;height:%?30?%}\n\n/* 退出登录按钮 */.logout-container[data-v-6c255df7]{padding:%?40?% %?20?%}.logout-btn[data-v-6c255df7]{width:%?630?%;height:%?100?%;background:linear-gradient(180deg,#fc303d 0,#fc1074);color:#fff;font-size:%?32?%;font-weight:700;border-radius:%?20?%;line-height:%?100?%;border:none;transition:background-color .3s}.logout-btn[data-v-6c255df7]:active{background-color:#ff3742}\n\n/* 弹窗样式 */.modal-overlay[data-v-6c255df7]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000}.modal-content[data-v-6c255df7]{width:%?600?%;background-color:#fff;border-radius:%?20?%;overflow:hidden}.modal-header[data-v-6c255df7]{display:flex;align-items:center;justify-content:space-between;padding:%?30?%;border-bottom:%?1?% solid #e0e0e0}.modal-title[data-v-6c255df7]{font-size:%?36?%;font-weight:700;color:#333}.close-btn[data-v-6c255df7]{padding:%?10?%}.close-icon[data-v-6c255df7]{width:%?40?%;height:%?40?%}.modal-body[data-v-6c255df7]{padding:%?30?%}.input-field[data-v-6c255df7]{width:100%;height:%?80?%;border:%?2?% solid #e0e0e0;border-radius:%?10?%;padding:0 %?20?%;font-size:%?30?%;box-sizing:border-box}.textarea-field[data-v-6c255df7]{width:100%;height:%?200?%;border:%?2?% solid #e0e0e0;border-radius:%?10?%;padding:%?20?%;font-size:%?30?%;box-sizing:border-box;resize:none}.char-count[data-v-6c255df7]{font-size:%?24?%;color:#999;text-align:right;margin-top:%?10?%}.gender-option[data-v-6c255df7]{display:flex;align-items:center;justify-content:space-between;padding:%?30?% 0;border-bottom:%?1?% solid #f0f0f0}.gender-option[data-v-6c255df7]:last-child{border-bottom:none}.gender-text[data-v-6c255df7]{font-size:%?32?%;color:#333}.radio[data-v-6c255df7]{width:%?40?%;height:%?40?%;border:%?2?% solid #e0e0e0;border-radius:%?20?%;position:relative}.radio.active[data-v-6c255df7]{border-color:#007aff}.radio.active[data-v-6c255df7]::after{content:"";position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:%?20?%;height:%?20?%;background-color:#007aff;border-radius:%?10?%}.modal-footer[data-v-6c255df7]{display:flex;padding:%?30?%;border-top:%?1?% solid #e0e0e0;gap:%?20?%}.cancel-btn[data-v-6c255df7],\n.confirm-btn[data-v-6c255df7]{flex:1;height:%?80?%;border-radius:%?10?%;border:none;font-size:%?30?%}.cancel-btn[data-v-6c255df7]{background-color:#f0f0f0;color:#666}.confirm-btn[data-v-6c255df7]{background-color:#007aff;color:#fff}',""]),t.exports=e},"9bfe":function(t,e,a){"use strict";a.r(e);var n=a("8f6a"),i=a.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);e["default"]=i.a},a03b:function(t,e,a){var n=a("968a");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=a("967d").default;i("57b52c48",n,!0,{sourceMap:!1,shadowMode:!1})}}]);