(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-recharge-recharge"],{27367:function(t,e,n){"use strict";n.r(e);var a=n("45e6"),i=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=i.a},"2f7c":function(t,e,n){"use strict";var a=n("6428"),i=n.n(a);i.a},"45e6":function(t,e,n){"use strict";n("6a54");var a=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,o=a(n("39d8"));n("c9b5"),n("bf0f"),n("ab80"),n("0c26");var s={data:function(){return{userInfo:{},presetAmounts:[50,100,200,300,500],selectedAmount:0,isCustomActive:!1,selectedPayment:1,paymentMethods:[{type:1,name:"微信支付",icon:"/static/icon/wechat.png"},{type:2,name:"支付宝支付",icon:"/static/icon/alipay.png"},{type:3,name:"USDT支付",icon:"/static/icon/usdt.png"}],loading:!1,currentOrderId:null,showUsdtDialog:!1,usdtAddress:"",usdtPaymentInfo:null}},computed:{finalAmount:function(){return this.selectedAmount||"0"},canRecharge:function(){return this.selectedAmount>0&&this.selectedPayment&&!this.loading}},onLoad:function(){this.getUserInfo()},onShow:function(){var t=getApp().getCache("isLogin");getApp().isEmpty(t)&&uni.navigateTo({url:"/pages/login/login"})},methods:(i={selectAmount:function(t){this.selectedAmount=t,this.isCustomActive=!1},getUserInfo:function(){var t=this,e=getApp().getCache("userInfo"),n=e?e.token:null;n?uni.request({url:getApp().globalData.baseUrl+"api/getuserinfo",method:"POST",header:{token:n},success:function(e){200===e.data.code?t.userInfo=e.data.data:uni.showToast({title:e.data.msg||"获取用户信息失败",icon:"none"})},fail:function(){uni.showToast({title:"网络错误",icon:"none"})}}):uni.showToast({title:"请先登录",icon:"none"})},goBack:function(){uni.navigateBack()}},(0,o.default)(i,"selectAmount",(function(t){this.selectedAmount=t,this.isCustomActive=!1})),(0,o.default)(i,"selectCustom",(function(){var t=this;this.selectedAmount=0,this.isCustomActive=!0,this.$nextTick((function(){var e=t.$refs.amountInput;e&&e.focus()}))})),(0,o.default)(i,"onAmountInput",(function(){this.isCustomActive||(this.isCustomActive=!0)})),(0,o.default)(i,"selectPayment",(function(t){this.selectedPayment=t})),(0,o.default)(i,"recharge",(function(){if(this.canRecharge){var t=this.selectedAmount;t<=0?uni.showToast({title:"充值金额必须大于0",icon:"none"}):this.createOrder(t)}else uni.showToast({title:"请选择充值金额和支付方式",icon:"none"})})),(0,o.default)(i,"createOrder",(function(t){var e=this,n=getApp().getCache("userInfo"),a=n?n.token:null;a?(uni.showLoading({title:"创建订单中..."}),uni.request({url:getApp().globalData.baseUrl+"api/order/create",method:"POST",header:{token:a,"Content-Type":"application/json"},data:{type:"recharge",amount:t.toString()},success:function(n){if(uni.hideLoading(),200===n.data.code){var a=n.data.data;e.payOrder(a,t)}else uni.showToast({title:n.data.msg||"创建订单失败",icon:"none"})},fail:function(){uni.hideLoading(),uni.showToast({title:"网络错误",icon:"none"})}})):uni.showToast({title:"请先登录",icon:"none"})})),(0,o.default)(i,"payOrder",(function(t,e){var n=this,a=getApp().getCache("userInfo"),i=a?a.token:null;i?(this.currentOrderId=t,uni.showLoading({title:"处理支付中..."}),uni.request({url:getApp().globalData.baseUrl+"api/order/pay",method:"POST",header:{token:i,"Content-Type":"application/json"},data:{id:t,paytype:this.selectedPayment,type:"recharge"},success:function(t){uni.hideLoading(),200===t.data.code?0===n.selectedPayment?(uni.showToast({title:"充值成功",icon:"success"}),n.getUserInfo()):n.handlePaymentResult(t.data.data):uni.showToast({title:t.data.msg||"支付失败",icon:"none"})},fail:function(){uni.hideLoading(),uni.showToast({title:"网络错误",icon:"none"})}})):uni.showToast({title:"请先登录",icon:"none"})})),(0,o.default)(i,"handlePaymentResult",(function(t){3===this.selectedPayment?(this.usdtPaymentInfo=t,this.showUsdtDialog=!0):t.payUrl&&uni.showModal({title:"支付提示",content:"请在新页面完成支付",showCancel:!1,success:function(e){e.confirm&&window.open(t.payUrl,"_blank")}})})),(0,o.default)(i,"closeUsdtDialog",(function(){this.showUsdtDialog=!1,this.usdtAddress="",this.usdtPaymentInfo=null})),(0,o.default)(i,"submitUsdtAddress",(function(){this.usdtAddress&&this.usdtAddress.trim()?this.completeUsdtPayment():uni.showToast({title:"请输入USDT转账地址",icon:"none"})})),(0,o.default)(i,"completeUsdtPayment",(function(){var t=this,e=getApp().getCache("userInfo"),n=e?e.token:null;n?(uni.showLoading({title:"提交中..."}),uni.request({url:getApp().globalData.baseUrl+"api/order/complete",method:"POST",header:{token:n,"Content-Type":"application/json"},data:{id:this.currentOrderId,type:"recharge",usdt_address:this.usdtAddress.trim()},success:function(e){uni.hideLoading(),200===e.data.code?(uni.showToast({title:"充值申请已提交，请等待审核",icon:"success",duration:2e3}),t.closeUsdtDialog(),t.currentOrderId=null,setTimeout((function(){t.getUserInfo()}),2e3)):uni.showToast({title:e.data.msg||"提交失败",icon:"none"})},fail:function(){uni.hideLoading(),uni.showToast({title:"网络错误",icon:"none"})}})):uni.showToast({title:"请先登录",icon:"none"})})),i)};e.default=s},"46c3":function(t,e,n){var a=n("c86c");e=a(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.amount-input[data-v-530b29be]{width:100%;text-align:center;font-size:%?36?%;color:#e84840;font-weight:700;padding:%?20?% 0}.recharge-page[data-v-530b29be]{background-color:#f5f5f5;min-height:100vh}\n/* 头部导航 */.header[data-v-530b29be]{display:flex;align-items:center;justify-content:space-between;padding:%?20?% %?30?%;background-color:#fff;border-bottom:%?1?% solid #f0f0f0}.back-btn[data-v-530b29be]{width:%?40?%;height:%?40?%;display:flex;align-items:center;justify-content:center}.back-icon[data-v-530b29be]{width:%?40?%;height:%?40?%}.header-title[data-v-530b29be]{font-size:%?32?%;color:#333}.placeholder[data-v-530b29be]{width:%?40?%;height:%?40?%}\n/* 余额显示 */.balance-container[data-v-530b29be]{padding:%?30?%;background-color:#e84840;margin-bottom:%?20?%;text-align:center;align-items:center;height:%?150?%;line-height:%?150?%;display:flex;font-size:%?32?%;width:%?690?%;margin:%?30?% auto;border-radius:%?20?%}.balance-label[data-v-530b29be]{color:#fff;display:block}.balance-amount[data-v-530b29be]{font-weight:600;color:#fff;display:block}\n/* 金额选择 */.amount-container[data-v-530b29be]{padding:%?30?%;background-color:#fff;margin-bottom:%?20?%}.section-title[data-v-530b29be]{font-size:%?32?%;font-weight:600;color:#333;margin-bottom:%?30?%;display:block}.amount-grid[data-v-530b29be]{display:grid;grid-template-columns:repeat(3,1fr);gap:%?20?%;margin-bottom:%?30?%}\n/* 自定义金额输入框样式 */.custom-amount[data-v-530b29be]{margin-top:%?20?%}.custom-label[data-v-530b29be]{font-size:%?28?%;color:#666;margin-bottom:%?15?%;display:block}.custom-input[data-v-530b29be]{width:100%;padding:%?25?% %?20?%;border:%?2?% solid #e0e0e0;border-radius:%?12?%;font-size:%?32?%;background-color:#fff;box-sizing:border-box}.custom-input[data-v-530b29be]:focus{border-color:#e84840}.amount-item[data-v-530b29be]{text-align:center;border:%?2?% solid #e0e0e0;border-radius:%?15?%;background-color:#fff;transition:all .3s;height:%?150?%;line-height:%?150?%}.amount-item.active[data-v-530b29be]{border-color:#e84840}.amount-text[data-v-530b29be]{font-size:%?32?%;color:#999}.amount-item.active .amount-text[data-v-530b29be]{color:#e84840}\n/* 支付方式 */.payment-container[data-v-530b29be]{margin-bottom:%?40?%;width:%?690?%;margin:0 auto}.payment-methods[data-v-530b29be]{display:flex;flex-direction:column}.payment-item[data-v-530b29be]{display:flex;align-items:center;padding:%?30?% %?15?%;margin-bottom:%?10?%;border-radius:%?12?%;background-color:#fff;transition:all .3s}.payment-item.active[data-v-530b29be]{background-color:#fff}.payment-info[data-v-530b29be]{display:flex;align-items:center;flex:1}.payment-icon[data-v-530b29be]{width:%?40?%;height:%?40?%;margin-right:%?20?%}.payment-name[data-v-530b29be]{font-size:%?32?%;margin-left:%?20?%;font-weight:700;color:#333}.checkbox[data-v-530b29be]{width:%?32?%;height:%?32?%;border:%?2?% solid #ccc;border-radius:50%;position:relative;display:flex;align-items:center;justify-content:center}.checkbox.checked[data-v-530b29be]{border-color:#fc1665;background-color:#fc1665}.check-mark[data-v-530b29be]{color:#fff;font-size:%?20?%;font-weight:700}\n/* 充值金额显示 */.final-amount-container[data-v-530b29be]{margin:%?20?% %?30?%;border-bottom:%?1?% solid #000;display:flex;align-items:center;justify-content:space-between}.amount-label[data-v-530b29be]{font-size:%?32?%;color:#333;font-weight:600}.amount-value[data-v-530b29be]{font-size:%?36?%;color:#e84840;text-align:left;font-weight:700}\n/* 充值按钮 */.recharge-btn-container[data-v-530b29be]{padding:0 %?30?% %?40?%;margin-top:%?30?%}.recharge-btn[data-v-530b29be]{width:100%;padding:%?10?%;background-color:#e84840;color:#fff;font-size:%?36?%;border-radius:%?15?%;border:none;transition:all .3s}.recharge-btn[disabled][data-v-530b29be]{background-color:#fc1d5d;color:#fff}\n/* USDT支付对话框样式 */.usdt-dialog-overlay[data-v-530b29be]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);z-index:1000;display:flex;align-items:center;justify-content:center}.usdt-dialog[data-v-530b29be]{width:90%;max-width:%?600?%;background-color:#fff;border-radius:%?20?%;overflow:hidden;max-height:80vh;display:flex;flex-direction:column}.dialog-header[data-v-530b29be]{display:flex;align-items:center;justify-content:space-between;padding:%?30?%;border-bottom:%?1?% solid #f0f0f0;background-color:#e84840}.dialog-title[data-v-530b29be]{font-size:%?32?%;font-weight:700;color:#fff}.close-btn[data-v-530b29be]{width:%?60?%;height:%?60?%;display:flex;align-items:center;justify-content:center;border-radius:50%;background-color:hsla(0,0%,100%,.2)}.close-icon[data-v-530b29be]{font-size:%?40?%;color:#fff;font-weight:700}.dialog-content[data-v-530b29be]{padding:%?30?%;flex:1;overflow-y:auto}.info-item[data-v-530b29be]{display:flex;align-items:flex-start;margin-bottom:%?20?%;padding:%?15?% 0}.info-label[data-v-530b29be]{font-size:%?28?%;color:#666;min-width:%?140?%;flex-shrink:0}.info-value[data-v-530b29be]{font-size:%?28?%;color:#333;flex:1;word-break:break-all}.address-text[data-v-530b29be]{font-family:monospace;background-color:#f8f8f8;padding:%?10?%;border-radius:%?8?%}.usdt-amount[data-v-530b29be]{color:#ff9500;font-weight:700}.qr-container[data-v-530b29be]{display:flex;justify-content:center;margin:%?20?% 0;padding:%?20?%;background-color:#f8f8f8;border-radius:%?15?%}.qr-image[data-v-530b29be]{width:%?300?%;height:%?300?%;border-radius:%?10?%}.input-container[data-v-530b29be]{margin-top:%?30?%}.input-label[data-v-530b29be]{font-size:%?28?%;color:#333;margin-bottom:%?15?%;display:block}.address-input[data-v-530b29be]{width:100%;height:%?120?%;border-radius:%?10?%;padding:%?15?%;font-size:%?26?%;color:#333;background-color:#fafafa;box-sizing:border-box;resize:none}.address-input[data-v-530b29be]:focus{border-color:#e84840;background-color:#fff}.dialog-footer[data-v-530b29be]{display:flex;gap:%?20?%;margin-top:%?20?%;padding-top:%?30?%}.cancel-btn[data-v-530b29be],\n.submit-btn[data-v-530b29be]{flex:1;height:%?80?%;border-radius:%?40?%;font-size:%?30?%;border:none;cursor:pointer;transition:all .3s}.cancel-btn[data-v-530b29be]{background-color:#f5f5f5;color:#666}.cancel-btn[data-v-530b29be]::after{border:none}.cancel-btn[data-v-530b29be]:hover{background-color:#e0e0e0}.submit-btn[data-v-530b29be]{background-color:#e84840;color:#fff}.submit-btn[data-v-530b29be]:hover{background-color:#d63031}',""]),t.exports=e},6428:function(t,e,n){var a=n("46c3");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("967d").default;i("b29f19a6",a,!0,{sourceMap:!1,shadowMode:!1})},d190:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"recharge-page"},[n("v-uni-view",{staticClass:"header"},[n("v-uni-view",{staticClass:"back-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goBack.apply(void 0,arguments)}}},[n("v-uni-image",{staticClass:"back-icon",attrs:{src:"/static/home/ic_common_back.png",mode:"aspectFit"}})],1),n("v-uni-text",{staticClass:"header-title"},[t._v("余额充值")]),n("v-uni-view",{staticClass:"placeholder"})],1),n("v-uni-view",{staticClass:"balance-container"},[n("v-uni-text",{staticClass:"balance-label"},[t._v("余额：")]),n("v-uni-text",{staticClass:"balance-amount"},[t._v(t._s(t.userInfo.money||"0.00"))])],1),n("v-uni-view",{staticClass:"amount-container"},[n("v-uni-view",{staticClass:"amount-grid"},[t._l(t.presetAmounts,(function(e){return n("v-uni-view",{key:e,staticClass:"amount-item",class:{active:t.selectedAmount===e&&!t.isCustomActive},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.selectAmount(e)}}},[n("v-uni-text",{staticClass:"amount-text"},[t._v(t._s(e))])],1)})),n("v-uni-view",{staticClass:"amount-item custom-btn",class:{active:t.isCustomActive},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.selectCustom.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"amount-text"},[t._v("自定义")])],1)],2),n("v-uni-view",{staticClass:"final-amount-container"},[n("v-uni-input",{ref:"amountInput",staticClass:"amount-value",attrs:{placeholder:"请输入金额"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.onAmountInput.apply(void 0,arguments)}},model:{value:t.selectedAmount,callback:function(e){t.selectedAmount=e},expression:"selectedAmount"}})],1)],1),n("v-uni-view",{staticClass:"payment-container"},[n("v-uni-view",{staticClass:"payment-methods"},t._l(t.paymentMethods,(function(e){return n("v-uni-view",{key:e.type,staticClass:"payment-item",class:{active:t.selectedPayment===e.type},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.selectPayment(e.type)}}},[n("v-uni-view",{staticClass:"payment-info"},[n("v-uni-view",{staticClass:"checkbox",class:{checked:t.selectedPayment===e.type}},[t.selectedPayment===e.type?n("v-uni-text",{staticClass:"check-mark"},[t._v("✓")]):t._e()],1),n("v-uni-text",{staticClass:"payment-name"},[t._v(t._s(e.name))])],1)],1)})),1)],1),n("v-uni-view",{staticClass:"recharge-btn-container"},[n("v-uni-button",{staticClass:"recharge-btn",attrs:{disabled:!t.canRecharge},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.recharge.apply(void 0,arguments)}}},[t._v("充值")])],1),t.showUsdtDialog?n("v-uni-view",{staticClass:"usdt-dialog-overlay",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeUsdtDialog.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"usdt-dialog",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)}}},[n("v-uni-view",{staticClass:"dialog-header"},[n("v-uni-text",{staticClass:"dialog-title"},[t._v("USDT充值")]),n("v-uni-view",{staticClass:"close-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeUsdtDialog.apply(void 0,arguments)}}},[n("v-uni-text",{staticClass:"close-icon"},[t._v("×")])],1)],1),t.usdtPaymentInfo?n("v-uni-view",{staticClass:"dialog-content"},[n("v-uni-view",{staticClass:"info-item"},[n("v-uni-text",{staticClass:"info-label"},[t._v("汇率：")]),n("v-uni-text",{staticClass:"info-value"},[t._v(t._s(t.usdtPaymentInfo.exchange_rate))])],1),n("v-uni-view",{staticClass:"info-item"},[n("v-uni-text",{staticClass:"info-label"},[t._v("收款地址：")]),n("v-uni-text",{staticClass:"info-value address-text"},[t._v(t._s(t.usdtPaymentInfo.usdt_address))])],1),n("v-uni-view",{staticClass:"info-item"},[n("v-uni-text",{staticClass:"info-label"},[t._v("应付金额：")]),n("v-uni-text",{staticClass:"info-value amount-text"},[t._v(t._s(t.usdtPaymentInfo.money)+" CNY")])],1),n("v-uni-view",{staticClass:"info-item"},[n("v-uni-text",{staticClass:"info-label"},[t._v("USDT金额：")]),n("v-uni-text",{staticClass:"info-value usdt-amount"},[t._v(t._s(t.usdtPaymentInfo.usdt_money)+" USDT")])],1),n("v-uni-view",{staticClass:"input-container"},[n("v-uni-text",{staticClass:"input-label"},[t._v("请输入您的USDT转账地址：")]),n("v-uni-textarea",{staticClass:"address-input",attrs:{placeholder:"请输入USDT转账地址",maxlength:"200"},model:{value:t.usdtAddress,callback:function(e){t.usdtAddress=e},expression:"usdtAddress"}})],1),n("v-uni-view",{staticClass:"dialog-footer"},[n("v-uni-button",{staticClass:"cancel-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeUsdtDialog.apply(void 0,arguments)}}},[t._v("取消")]),n("v-uni-button",{staticClass:"submit-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submitUsdtAddress.apply(void 0,arguments)}}},[t._v("提交")])],1)],1):t._e()],1)],1):t._e()],1)},i=[]},def2:function(t,e,n){"use strict";n.r(e);var a=n("d190"),i=n("27367");for(var o in i)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(o);n("2f7c");var s=n("828b"),c=Object(s["a"])(i["default"],a["b"],a["c"],!1,null,"530b29be",null,!1,a["a"],void 0);e["default"]=c.exports}}]);